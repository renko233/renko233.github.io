
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <title>密度泛函理论基础(1) | 東雲研究所</title>
    <meta name="author" content="Renko" />
    <meta name="description" content="studying..." />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/head.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>







<script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.39/dist/twikoo.all.min.js"></script>



<link rel="stylesheet" href="/css/main.css" />

    
  
    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">


    <!-- 在线通讯Tidio -->
    
    <script src="//code.tidio.co/9xgs2ktdmwcpepxvdyyn2tuli1ilrf5o.js"></script>
    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
             // customised options
             // • auto-render specific keys, e.g.:
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                    {left: '\\(', right: '\\)', display: false},
                    {left: '\\[', right: '\\]', display: true}
                 ],
                // • rendering keys, e.g.:
                throwOnError : false
             });
        });
    </script>

    <link rel="stylesheet" href="/css/custom.css" />
   
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    
    <script src="/js/title.js"></script>

   
    

    
<meta name="generator" content="Hexo 7.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>人生天地之间，若白驹之过隙，忽然而已。</p>
                    <img src="/images/loading6.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>東雲研究所</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;主页</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;关于</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;时间线</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;分类</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;标签</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;東雲研究所</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 100%">主页</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 100%">关于</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 100%">时间线</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 100%">分类</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 100%">标签</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>密度泛函理论基础(1)</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/9/27
        </span>
        
        <span class="category">
            <a href="/categories/%E6%9D%90%E6%96%99/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                材料
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9D%90%E6%96%99%E5%AD%A6/" style="color: #03a9f4">
                    计算材料学
                </a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/%E5%AF%86%E5%BA%A6%E6%B3%9B%E5%87%BD%E7%90%86%E8%AE%BA/" style="color: #ffa2c4">
                    密度泛函理论
                </a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <p> 最近上到密度泛函理论基础了，不过在此之前还上了Hartree-Fock方法的一些介绍与推导，虽然我没听，好吧，其实最近上来密度泛函理论我也没听。不过鉴于Hartree-Fock方法在网上能找到推导的过程，所以我就不写了，直接把网站码出来了。<br>
知乎(中文)：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/677955631">https://zhuanlan.zhihu.com/p/677955631</a><br>
原链接(英文)：<a target="_blank" rel="noopener" href="https://insilicosci.com/hartree-fock-method-a-simple-explanation/">https://insilicosci.com/hartree-fock-method-a-simple-explanation/</a></p>
<br>
<br>
<h1>Schrödinger方程</h1>
<p> 在多电子与多原子核交互作用体系下的不含时Schrödinger方程可写作:</p>
<p>$$<br>
[-\frac{h^2}{2m} \displaystyle\sum_{i=1}^N \nabla <em>i^2 + \displaystyle\sum</em>{i=1}^N V(r_i) + \displaystyle\sum_{i=1}^N \sum_{j&lt;i} U(r_i,r_j)]\psi = E\psi<br>
$$</p>
<p>$m$为电子质量。左式的三项能量分布代表每个电子的动能、每个电子与所有原子核之间的作用能、不同电子之间的作用能。$\psi$是电子波函数，它是N个电子每个电子空间坐标的函数，即$\psi=\psi(r_1,…,r_N)$，$E$是电子的基态能量。</p>
<p> 尽管电子波函数是N个电子坐标的函数，但可将$\psi$近似的表达为单个波函数的乘积$\psi=\psi_1®…\psi_N®$，也就是所谓的Hartree乘积(Hartree Product)。但由于实际材料的复杂度使得Schrödinger方程的直接求解难度令人困扰。同时在哈密顿量中的电子相互作用能也是难以确定的，需要考虑该电子与其他所有电子有关的波函数，换言之，Schrödinger方程是一个多体问题。</p>
<p> 由于理论上是无法直接观测到某套特定坐标的波函数的，能够测量的是N个电子在某套特定坐标$(r_1,…,r_N)$出现的概率$\psi ^* (r_1,…,r_N) \psi (r_1,…,r_N)$，在实验上的材料中需要的物理量实际上就是一套N个电子位于某套坐标时的概率值。与此概率值密切相关的一个物理量是空间中某个具体位置上的电荷密度$n®$。可用单电子波函数的形式写作：</p>
<p>$$<br>
n®=2\sum_{i} \psi _i^* ® \psi _i ®<br>
$$</p>
<p>此式表示的是电子系统所占据的全部单电子波函数的求和，求和式中的表达式是单电子波函数$\psi _i ®$中一个电子位于$r$处的概率。而前面的因子2的出现是因为电子具有自旋的性质，且泡利不相容原理所表明的单电子波函数能够被不同自旋的两个电子所占据，因子需乘2。该式的要点在于电荷密度$n®$是一个三个坐标的函数，却含有Schrödinger方程全波函数解的大量信息，而该全波函数却是3N个坐标的复杂函数。</p>
<h1>Hohenberg-Kohn定理</h1>
<p> 密度泛函理论全部建立在由Hohenberg与Kohn所证明的两个基本数学定理与二人所推演的一套方程的基础上。这两个定理分别是：</p>
<p>定理1：不计自旋的全同费米子系统的基态能量是电荷密度的唯一泛函。</p>
<p>定理2：能量泛函在粒子数不变的条件下，对正确的电荷密度函数取极小值等于基态能量。</p>
<p> 定理1表明了基态电荷密度唯一决定了基态的所有性质，包括能量和波函数，这意味着可以通过找到含有3个空间变量的电荷密度函数来求解Schrödinger方程，而无需求解得到含有3N个变量的波函数，将多维计算的复杂度简化到了一个只有3维的问题。</p>
<p> 其中定理1严格证明了存在一个可用于求解Schrödinger方程的电荷密度泛函，却并未给出该泛函的具体形式，因此定理2给出了这个泛函的一个重要特征：使整体泛函最小化的电荷密度就是对应于Schrödinger方程完全解的真实电荷密度。如果已知这个“真实的”泛函形式，就能通过不断调整电荷密度直至由泛函所确定的能量达到最小化，并可用找到相应的电荷密度。</p>
<p> 将Hohenberg-Kohn定理所描述的泛函写成单电子波函数$\psi _i®$的形式是一个有益的方法，在前面的电荷密度表达式中由这些泛函整体定义了电荷密度$n®$。能量泛函可写作：</p>
<p>$$<br>
E[{\psi <em>i}]=E</em>{known}[{\psi <em>i}]+E</em>{XC}[{\psi _i}]<br>
$$</p>
<p>其中将泛函分开写作两项：具有简单解析形式的 $E_{known}[{\psi <em>i}]$，所有的其他部分 $E</em>{XC}[{\psi <em>i}]$。其中 $E</em>{known}[{\psi _i}]$包含四方面的贡献：</p>
<p>$$<br>
E_{known}[{\psi <em>i}]= -\frac{h^2}{2m}\sum</em>{i} \int \psi _i^* \nabla ^2 \psi <em>i d^3 r + \int V®n® d^3 r + \frac{e^2}{2} \iint \frac{n®n(r<sup>{'})}{|r-r</sup>{‘}|}d^3 r d^3 r^{’} + E</em>{ion}<br>
$$</p>
<p>在上式右侧的项依次代表：电子的动能，电子和原子核之间的库伦作用，电子之间的库伦作用，原子核之间的库伦作用。对于$V_{XC}$能量泛函完整表达式中的另一项$E_{XC}[{\psi _i}]$是交换关联泛函，它所定义的是没有包括在“known”这一项中的所有其他量子力学效应。</p>
<h1>Kohn-Sham方程</h1>
<p> 虽然Hohenberg-Kohn定理证明了总能可通过求解基态电子密度函数得到，但对于其具体泛函形式以及如何利用极小值求解总能的问题却没有给出解答。而这个难题由Kohn与Sham所解决，他们给出了这样一个结果：求解正确的电荷密度可以表示为求解一套方程，而其中每个方程都只与一个电子有关。</p>
<p> Kohn-Sham方程的表达式为：</p>
<p>$$<br>
[-\frac{h^2}{m} \nabla ^2 + V® +V_H® +V_{XC}®]\psi _i ® = \varepsilon _i \psi _i ®<br>
$$</p>
<p>表面上看来这只是在交互体系下的Schrödinger方程中去掉了求和符号，这是由于Kohn-Sham方程的解是只取决3个空间变量的单电子波函数$\psi <em>i ®$。在Kohn-Sham方程左侧有三个势能项$V , V_H , V</em>{XC}$。其中第一个也就是一个电子与所有原子核之间的相互作用势。第二个势能也成为Hartree势能，可写为：</p>
<p>$$<br>
V_H ® = e^2 \int \frac{n(r^{‘})}{|r - r^{’}|} d^3 r^{'}<br>
$$</p>
<p>这个势能描述的是一个Kohn-Sham方程所考虑的单个电子，与该体系中全部电子所产生的总电荷密度之间的库伦作用，也就是将多电子问题转化为了单电子问题。因为Kohn-Sham方程中所描述的那个电子也是总体电荷密度的一部分，所以Hartree势能中包含了一个所谓的自作用(Self-Interaction)部分，也就是那个电子与自身的库伦作用。自作用是物理上不存在的，因此在Kohn-Sham方程的完整表达式中，将其合并到单电子方程的交换作用能中进行修正，且这只是$V_{XC}$中的的一部分。$V_{XC}$在形式上可以表示为交换关联能的“泛函导数”，即：</p>
<p>$$<br>
V_{XC} ® = \frac{\delta E_{XC} ®}{\delta n®}<br>
$$</p>
<p> 在以上有关Kohn-Sham方程的讨论中似乎陷入了一个循环：为了求解Kohn-Sham方程，需要确定Hartree势能；为了确定Hartree势能，又需要知道电荷密度；为了知道电荷密度，又必须知道单电子波函数方程；为了知道波函数，又需要求解Kohn-Sham方程…因此为了打破循环，这个问题通常使用迭代算法处理，也就是自洽(Self-Consistent)求解过程， 其步骤简述为：</p>
<p> (1) 定义一个初始性、尝试性的电荷密度$n®$。</p>
<p> (2) 求解定义的电荷密度所确定的Kohn-Sham方程，得到单电子波函数$\psi _i ®$。</p>
<p> (3) 计算由(2)所得单电子波函数所确定的电荷密度，即$n_{KS}®= 2 \sum_{i} \psi _i^* ® \psi _i ®$。</p>
<p> (4) 比较计算得到的电荷密度$n_{KS}®$和在求解Kohn-Sham方程时定义的电荷密度$n®$。如果两个电荷密度相同，这就是基态电荷密度，并可将其用于计算总能。如果两个电荷密度不相同，则用某种方式对尝试性的电荷密度进行修正，并从第(2)部重新开始。<br>
<br><br>
<br><br>
<br><br>
参考书籍：<br>
(1)《Density Functional Theory》(密度泛函理论)————David S.Sholl<br>
(2)《计算材料学——设计实践方法》————江建军<br>
<br></p>
<hr>
<br>
&emsp;目前上课好像就上到了这里，不过也不知道自己在此记录的和老师于课上讲的是否有出入，不过有也无所谓了，反正咱是摆子，明天28号调休放假一天，后天29号周日还要补课，并且30号周一也是正常上课，这两天都有计算材料学要上，不过估计还是上课狂玩然后玩过去了。
<p><img src="/images/postimage/2024-9-27.jpg" alt="2024-9-27"></p>
<center>会听吗？ </center>
    </div>
    
    
    
    
    
    
    <div id="comment">
        <div id="twikoo-container"></div>
    </div>
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            1985 - 2024 東雲研究所
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Renko
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    



<script>
    twikoo.init({
        el: "#twikoo-container",
        envId: "https://twikoo.renko.space/",
        region: "",
        path: location.pathname,
        lang: "",
    })
</script>


    
    
    
    

</body>
</html>
 <canvas
    id="fireworks"
    style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"
 ></canvas>
 <script src="https://s4.zstatic.net/ajax/libs/animejs/3.2.1/anime.min.js"></script>
 <script src="/js/fireworks.min.js"></script>
<html>
 <canvas
    id="background"
    style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: -1"
 ></canvas>
 <script src="/js/background.min.js"></script>
 
 

 
</html>